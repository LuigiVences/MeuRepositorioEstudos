<!DOCTYPE html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Home - TCC</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/home_page.css}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

</head>
<body>

<!-- Botão de toggle para mobile -->
<button class="btn btn-dark sidebar-toggle" onclick="toggleSidebar()">
    <i class="bi bi-list"></i>
</button>

<!-- Menu Lateral -->
<div class="sidebar" id="sidebar">
    <h4 class="text-center">TCC</h4>
    <hr class="text-secondary">

    <!-- Organização (protegida) -->
    <div th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
        <a href="#" onclick="toggleSubmenu('orgSubmenu')">
            <i class="bi bi-building"></i> Organização <i class="bi bi-caret-down ms-auto"></i>
        </a>
        <div id="orgSubmenu" class="submenu flex-column">
            <a th:href="@{/organizacao/criar}"><i class="bi bi-plus-circle"></i> Criar Novo</a>
            <a th:href="@{/organizacao/editar}"><i class="bi bi-pencil-square"></i> Editar</a>
            <a th:href="@{/organizacao/listar}"><i class="bi bi-list-ul"></i> Listar</a>
        </div>
    </div>

    <!-- Usuário (protegida) -->
    <div th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
        <a href="#" onclick="toggleSubmenu('userSubmenu')">
            <i class="bi bi-person"></i> Usuário <i class="bi bi-caret-down ms-auto"></i>
        </a>
        <div id="userSubmenu" class="submenu flex-column">
            <a th:href="@{/usuario/criar}"><i class="bi bi-plus-circle"></i> Criar Novo</a>
            <a th:href="@{/usuario/editar}"><i class="bi bi-pencil-square"></i> Editar</a>
            <a th:href="@{/usuario/listar}"><i class="bi bi-list-ul"></i> Listar</a>
            <a th:href="@{/usuario/vincular-organizacao}"><i class="bi bi-link-45deg"></i> Vincular Organização</a>
            <a th:href="@{/usuario/atribuir-funcao}"><i class="bi bi-shield-lock"></i> Atribuir Função</a>
        </div>
    </div>

    <!-- Registro (aberto para todos) -->
    <a th:href="@{/registro}"><i class="bi bi-clock-history"></i> Registro</a>

    <!-- Informações do usuário logado -->
    <div class="user-info">
        <p><i class="bi bi-person-circle"></i> <span th:text="${#authentication.name}"></span></p>

        <!-- Logout via POST -->
        <form th:action="@{/logout}" method="post" style="display:inline">
            <button type="submit" class="btn btn-danger btn-sm">
                <i class="bi bi-box-arrow-right"></i> Sair
            </button>
        </form>
    </div>
</div>

<!-- Conteúdo principal + rodapé -->
<div class="main-wrapper">
    <div class="main-content" id="mainContent">
        <h2>Sistema de Controle de Registro dos Ônibus do PAESE</h2>
        <p>Selecione uma opção no menu lateral para começar.</p>
    </div>

    <!-- Rodapé -->
    <footer class="footer">
        <p>© 2025 Sistema Paese Web - TCC LFV e MFC.</p>
    </footer>
</div>

<script th:src="@{/js/home_page.js}"></script>

</body>
</html>
